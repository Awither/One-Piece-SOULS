<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Soul Fruit Control Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="page">
    <header class="page-header">
      <h1>Soul Fruit Control Panel</h1>
      <p>Harvest souls, track Soul Power Units (SPU), create homies, and generate custom Soul Fruit abilities.</p>
    </header>

    <!-- PANEL 1: ADD NEW SOUL -->
    <section class="card card-collapsible" data-panel="1">
      <div class="card-header">
        <h2>1. Add a New Soul</h2>
        <button class="collapse-toggle" type="button">▼</button>
      </div>
      <div class="card-body">
        <div class="grid-2">
          <div class="field">
            <label for="soul-name">Soul Owner / Title</label>
            <input id="soul-name" type="text" placeholder="Brave Captain, Terrified Villager, Yonko, etc." />
          </div>

          <div class="field">
            <label for="soul-power">Raw Power (0–20)</label>
            <input id="soul-power" type="number" min="0" max="20" value="5" />
            <small>Overall combat / narrative strength of the creature.</small>
          </div>

          <div class="field">
            <label for="soul-fear">Fear at Extraction (0–10)</label>
            <input id="soul-fear" type="number" min="0" max="10" value="5" />
            <small>Higher fear makes the soul easier to control and stronger for offense.</small>
          </div>

          <div class="field">
            <label for="soul-attachment">Emotional Weight / Attachment (0–10)</label>
            <input id="soul-attachment" type="number" min="0" max="10" value="5" />
            <small>Important loved ones, strong dreams, or legendary status raise this.</small>
          </div>
        </div>

        <div class="actions-row">
          <button id="btn-calc-soul" type="button" class="btn-primary">Calculate Soul Level</button>
          <button id="btn-add-soul" type="button" class="btn-secondary">Add to Soul Library</button>
        </div>

        <div id="soul-calc-output" class="calc-output"></div>
      </div>
    </section>

    <!-- PANEL 2: MY SOULS -->
    <section class="card card-collapsible" data-panel="2">
      <div class="card-header">
        <h2>2. My Stored Souls</h2>
        <button class="collapse-toggle" type="button">▼</button>
      </div>
      <div class="card-body">
        <div class="totals-row">
          <span>Total Soul Power (SPU): <strong id="total-spu">0</strong></span>
          <span>Spent SPU: <strong id="spent-spu">0</strong></span>
          <span>Available SPU: <strong id="available-spu">0</strong></span>
        </div>
        <div id="soul-list" class="soul-list">
          <!-- soul cards injected here -->
        </div>
      </div>
    </section>

    <!-- PANEL 3: SPEND SPU ON BOONS -->
    <section class="card card-collapsible" data-panel="3">
      <div class="card-header">
        <h2>3. Spend SPU on Boons & Contracts</h2>
        <button class="collapse-toggle" type="button">▼</button>
      </div>
      <div class="card-body">
        <div class="field">
          <label for="buff-target-select">Current Beneficiary</label>
          <select id="buff-target-select"></select>
          <small>Boons are tracked per target (Soul Fruit user, each ally, each homie).</small>
        </div>

        <div class="ally-add-row">
          <input id="ally-name-input" type="text" placeholder="Add new ally / homie target name" />
          <button id="btn-add-ally" type="button" class="btn-secondary">Add Target</button>
        </div>

        <div class="field">
          <label for="buff-tools-select">Advanced Tools</label>
          <select id="buff-tools-select">
            <option value="hide">Hide tools</option>
            <option value="custom">Custom Boon Creator only</option>
            <option value="dc">Soul DC Helper only</option>
            <option value="both">Show both</option>
          </select>
        </div>

        <div id="buff-cards-container" class="buff-card-grid">
          <!-- buff cards injected here -->
        </div>

        <div id="selected-buffs-summary" class="selected-buffs-summary">
          <!-- selected buffs for current target -->
        </div>

        <!-- CUSTOM BOON CREATOR -->
        <div id="custom-buff-section" class="advanced-section hidden">
          <h3>Custom Boon / Contract</h3>
          <div class="grid-3">
            <div class="field">
              <label for="custom-buff-name">Name</label>
              <input id="custom-buff-name" type="text" placeholder="Soul-Forged Shell, Terror Pact, etc." />
            </div>
            <div class="field">
              <label for="custom-buff-cost">Base SPU Cost (first copy)</label>
              <input id="custom-buff-cost" type="number" min="1" value="10" />
            </div>
            <div class="field">
              <label for="custom-buff-min">Minimum Total SPU Required (optional)</label>
              <input id="custom-buff-min" type="number" min="0" value="0" />
            </div>
          </div>
          <div class="field">
            <label for="custom-buff-desc">Description</label>
            <textarea id="custom-buff-desc" rows="2" placeholder="What does this boon do mechanically? AC, HP, damage, movement, conditions, etc."></textarea>
          </div>
          <button id="btn-add-custom-buff" type="button" class="btn-secondary">Add Custom Boon</button>
        </div>

        <!-- SOUL DC HELPER -->
        <div id="dc-helper-section" class="advanced-section hidden">
          <h3>Soul DC Helper</h3>
          <div class="grid-3">
            <div class="field">
              <label for="dc-helper-sl">Soul Level (SL)</label>
              <input id="dc-helper-sl" type="number" min="1" max="10" value="5" />
              <small>Use your strongest stored soul or an average.</small>
            </div>
            <div class="field">
              <label for="dc-helper-prof">Proficiency Bonus</label>
              <input id="dc-helper-prof" type="number" value="3" />
            </div>
            <div class="field">
              <label for="dc-helper-mod">Spellcasting / Ability Modifier</label>
              <input id="dc-helper-mod" type="number" value="4" />
            </div>
          </div>
          <button id="btn-calc-dc" type="button" class="btn-secondary">Calculate Suggested DC</button>
          <div id="dc-helper-output" class="calc-output"></div>
        </div>
      </div>
    </section>

    <!-- PANEL 4: CREATE HOMIE -->
    <section class="card card-collapsible" data-panel="4">
      <div class="card-header">
        <h2>4. Create a Homie / Soul Construct</h2>
        <button class="collapse-toggle" type="button">▼</button>
      </div>
      <div class="card-body">
        <div class="grid-2">
          <div class="field">
            <label for="homie-name">Homie Name</label>
            <input id="homie-name" type="text" placeholder="Sun Homie, Living Cutlass, Castle Spirit, etc." />
          </div>
          <div class="field">
            <label for="homie-body">Body / Vessel</label>
            <input id="homie-body" type="text" placeholder="Sword, ship, house, storm cloud, fire, etc." />
          </div>
        </div>

        <div class="grid-2">
          <div class="field">
            <label for="homie-durability">Body Durability Tier (1–10)</label>
            <input id="homie-durability" type="number" min="1" max="10" value="5" />
            <small>How tough the physical object or elemental body is.</small>
          </div>
          <div class="field">
            <label for="homie-element">Element / Theme</label>
            <input id="homie-element" type="text" placeholder="Fire, storm, sweets, shadowy knight, etc." />
          </div>
        </div>

        <div class="field">
          <label for="homie-soul-mode">Which Souls Power It?</label>
          <select id="homie-soul-mode">
            <option value="active">Use active souls</option>
            <option value="all">Use all stored souls</option>
            <option value="selected">Use selected souls below</option>
          </select>
        </div>

        <div class="field">
          <label for="homie-soul-select">Custom Soul Selection</label>
          <select id="homie-soul-select" multiple></select>
          <small>Select specific souls when “Use selected souls below” is chosen.</small>
        </div>

        <div class="actions-row">
          <button id="btn-generate-homie" type="button" class="btn-primary">Generate Homie Stat Block</button>
          <button id="btn-edit-buffs-homie" type="button" class="btn-secondary">Edit Boons for This Homie</button>
        </div>

        <div id="homie-stat-block" class="homie-stat-block">
          <!-- generated homie card -->
        </div>
      </div>
    </section>

    <!-- PANEL 5: ASK THE SOULS (AI) -->
    <section class="card card-collapsible" data-panel="5">
      <div class="card-header">
        <h2>5. Ask the Souls (AI)</h2>
        <button class="collapse-toggle" type="button">▼</button>
      </div>
      <div class="card-body">
        <div class="field">
          <label for="ai-notes">Extra Notes / Theme</label>
          <textarea id="ai-notes" rows="3" placeholder="Example: terrifying battlefield controller, homie-focused build, defensive tank, etc."></textarea>
        </div>

        <div class="actions-row">
          <button id="btn-generate-abilities" type="button" class="btn-primary">Generate Soul Abilities with AI</button>
          <button id="btn-add-empty-ability" type="button" class="btn-secondary">Add Empty Ability Card</button>
        </div>

        <div id="ability-cards-container" class="ability-card-grid">
          <!-- AI ability cards -->
        </div>
      </div>
    </section>

    <!-- PANEL 6: SUMMARY -->
    <section class="card card-collapsible" data-panel="6">
      <div class="card-header">
        <h2>6. Current Summary (Soul Party Dashboard)</h2>
        <button class="collapse-toggle" type="button">▼</button>
      </div>
      <div class="card-body">
        <p>At-a-glance views for the Soul Fruit user, each ally, and each homie. Use this as a quick reference at the table.</p>
        <div id="summary-grid" class="summary-grid">
          <!-- summary cards -->
        </div>

        <div class="summary-actions">
          <button id="btn-save-now" type="button" class="btn-secondary">Save Now</button>
          <button id="btn-print" type="button" class="btn-secondary">Print Quick Reference</button>
          <button id="btn-reset" type="button" class="btn-danger">Reset All Data</button>
        </div>
        <p class="small-note">Data is automatically saved in your browser (localStorage).</p>
      </div>
    </section>
  </div>

  <script src="script.js" defer></script>
</body>
</html>
