<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Soul-Soul Fruit Workshop</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <!-- Global error / status banner -->
  <div id="app-error-banner" class="error-banner hidden">
    <span id="app-error-text"></span>
    <button id="app-error-close" type="button">×</button>
  </div>

  <header class="app-header">
    <div class="app-title">
      <h1>Soul-Soul Fruit Workshop</h1>
      <p>Big Mom–style soul harvesting, Homie crafting, domains, and abilities.</p>
    </div>
    <div class="app-meta">
      <div class="spu-display">
        <span>Total SPU:</span>
        <span id="spu-total">0</span>
      </div>
      <div class="spu-display">
        <span>SPU Spent:</span>
        <span id="spu-spent">0</span>
      </div>
      <div class="spu-display">
        <span>SPU Available:</span>
        <span id="spu-available">0</span>
      </div>
      <button id="btn-save-now" class="btn-secondary" type="button">Save Now</button>
      <button id="btn-reset-all" class="btn-danger" type="button">Reset</button>
      <button id="btn-print-reference" class="btn-primary" type="button">Print Reference</button>
    </div>
  </header>

  <main class="app-container">
    <!-- Panel 1 – SOULS -->
    <section class="panel" id="panel-souls">
      <h2 class="panel-title">Panel 1 – Soul Rating &amp; Soul Bank</h2>
      <div class="panel-body two-column">
        <!-- Soul Rating Form -->
        <div class="subpanel">
          <h3>Core Soul Rating (No Math Brain Required)</h3>
          <p class="subpanel-help">
            Input three things about the target to get a scaled Soul Energy result. This captures
            physical might, combat proficiency, and sheer willpower.
          </p>

          <label>
            Creature Name
            <input id="soul-name" type="text" placeholder="Kaido" />
          </label>

          <label>
            Raw Might (1–10)
            <input id="soul-might" type="number" min="0" max="10" value="5" />
            <span class="field-help">How physically / combat capable they are at baseline.</span>
          </label>

          <label>
            Proficiency Tier (0–9)
            <select id="soul-tier">
              <option value="0">0 – Fodder</option>
              <option value="1">1 – Rookie</option>
              <option value="2">2 – Veteran</option>
              <option value="3">3 – Super Rookie</option>
              <option value="4">4 – Commander</option>
              <option value="5">5 – Warlord</option>
              <option value="6">6 – Admiral</option>
              <option value="7">7 – Yonko</option>
              <option value="8">8 – Mythic</option>
              <option value="9">9 – World Threat</option>
            </select>
            <span class="field-help">Their “skill tier” in the world. Heavily influences the soul rating.</span>
          </label>

          <label>
            Willpower Level (1–10)
            <input id="soul-will" type="number" min="0" max="10" value="5" />
            <span class="field-help">How unbreakable their spirit is. This is the most important factor.</span>
          </label>

          <div class="derived-box">
            <p><strong>Combined Soul Rating:</strong> <span id="soul-rating">0</span></p>
            <p><strong>Soul Level (SoL):</strong> <span id="soul-level">0</span></p>
            <p><strong>Soul Energy (SPU):</strong> <span id="soul-spu">0</span></p>
            <p><strong>Suggested Max HP Lost:</strong> <span id="soul-hp">0</span></p>
          </div>

          <label>
            Traits / Tags (optional)
            <input id="soul-tags" type="text" placeholder="Ex: cowardly, marine, zealot" />
          </label>

          <label>
            Soul Notes
            <textarea id="soul-notes" rows="3" placeholder="Flavor, backstory, what broke their will, how they reacted..."></textarea>
          </label>

          <div class="button-row">
            <button id="btn-recalc-soul" class="btn-secondary" type="button">Recalculate Soul Rating</button>
            <button id="btn-add-soul" class="btn-primary" type="button">Add Soul to Bank</button>
          </div>
        </div>

        <!-- Soul Bank -->
        <div class="subpanel">
          <h3>Soul Bank</h3>
          <p class="subpanel-help">
            All harvested souls are stored here with their Soul Level and Soul Energy. These feed Homies, Domains, and Abilities.
          </p>

          <label>
            Filter by name / traits
            <input id="soul-filter" type="text" placeholder="Search souls..." />
          </label>

          <div id="soul-bank-list" class="card-list slim-scroll">
            <!-- populated by JS -->
          </div>
        </div>
      </div>
    </section>

    <!-- Panel 2 – HOMIES (creation only + simple list) -->
    <section class="panel" id="panel-homies">
      <h2 class="panel-title">Panel 2 – Homies (Creation)</h2>
      <div class="panel-body two-column">
        <div class="subpanel">
          <h3>Create a Homie</h3>
          <p class="subpanel-help">
            Spend Soul Energy (SPU) once to create a Homie. Their detailed attacks and support moves will be
            generated later by AI.
          </p>

          <label>
            Homie Name
            <input id="homie-name" type="text" placeholder="Panther" />
          </label>

          <label>
            Homie Type
            <select id="homie-type">
              <option value="Minor">Minor Homie</option>
              <option value="Territory">Territory Homie</option>
              <option value="Signature">Signature Homie (elite companion)</option>
            </select>
          </label>

          <label>
            Linked Soul (optional)
            <select id="homie-linked-soul">
              <option value="">— None —</option>
            </select>
          </label>

          <label>
            Initial SPU Investment
            <input id="homie-spu" type="number" min="0" step="10" value="0" />
            <span class="field-help">SPU you dedicate to bring the Homie into existence. More SPU = sturdier or more powerful.</span>
          </label>

          <label>
            Role / Concept
            <input id="homie-role" type="text" placeholder="Support, bruiser, scout, artillery..." />
          </label>

          <div class="three-column">
            <label>
              HP
              <input id="homie-hp" type="number" min="0" step="10" value="0" />
            </label>
            <label>
              AC
              <input id="homie-ac" type="number" min="0" value="10" />
            </label>
            <label>
              Move
              <input id="homie-move" type="number" min="0" value="30" />
            </label>
          </div>

          <label>
            Primary Damage / Attack
            <input id="homie-attack" type="text" placeholder="1d12 slashing" />
          </label>

          <label>
            Personality Traits (from souls used)
            <textarea id="homie-personality" rows="2" placeholder="Ex: arrogant, gluttonous, storm-obsessed, jealous, loyal."></textarea>
          </label>

          <label>
            Bound Location (optional)
            <input id="homie-location" type="text" placeholder="Ex: Southern Gate of Montblanc City" />
          </label>

          <label>
            Assigned Domain (optional)
            <select id="homie-domain">
              <option value="">— None yet —</option>
            </select>
          </label>

          <div class="button-row">
            <button id="btn-create-homie" class="btn-primary" type="button">Create Homie</button>
          </div>
        </div>

        <!-- Simple Homie list (no AI forge / upgrades here) -->
        <div class="subpanel">
          <h3>Homie Roster</h3>
          <p class="subpanel-help">
            Quick overview of all Homies you’ve created. Detailed attacks and usage live in Panel 5.
          </p>

          <label>
            Filter Homies
            <input id="homie-filter" type="text" placeholder="Search homies..." />
          </label>

          <div id="homie-roster" class="card-list slim-scroll">
            <!-- populated by JS -->
          </div>
        </div>
      </div>
    </section>

    <!-- Panel 3 – ABILITIES -->
    <section class="panel" id="panel-abilities">
      <h2 class="panel-title">Panel 3 – Ability Cards (Manual &amp; AI)</h2>
      <div class="panel-body two-column">
        <div class="subpanel">
          <h3>Create / Forge Ability</h3>
          <p class="subpanel-help">
            Create abilities manually or let the souls forge them based on effect types, power level, and a concept.
          </p>

          <label>
            Ability Name
            <input id="ability-name" type="text" placeholder="Soul Roots Binding" />
          </label>

          <label>
            Assign To
            <select id="ability-assign">
              <option value="general">General / Party</option>
            </select>
          </label>

          <div class="three-column">
            <label>
              Action Type
              <input id="ability-action" type="text" placeholder="Action, Bonus Action, Reaction" />
            </label>
            <label>
              Range
              <input id="ability-range" type="text" placeholder="Self, 30 ft., 60 ft. cone..." />
            </label>
            <label>
              Target
              <input id="ability-target" type="text" placeholder="Single creature, 30-ft radius, line..." />
            </label>
          </div>

          <div class="three-column">
            <label>
              Save / DC
              <input id="ability-dc" type="text" placeholder="Dex save DC 18, or —" />
            </label>
            <label>
              Damage Dice
              <input id="ability-damage" type="text" placeholder="6d10 necrotic + 4d8 thunder" />
            </label>
            <label>
              Ability Power Level (1–10)
              <input id="ability-power" type="number" min="1" max="10" value="7" />
            </label>
          </div>

          <label>
            Soul Energy Used (optional)
            <input id="ability-soulcost" type="number" min="0" step="10" value="0" />
          </label>

          <fieldset class="checkbox-group">
            <legend>Effect Types</legend>
            <label><input type="checkbox" class="ability-type" value="Offense" /> Offense</label>
            <label><input type="checkbox" class="ability-type" value="Defense" /> Defense</label>
            <label><input type="checkbox" class="ability-type" value="Support" /> Support</label>
            <label><input type="checkbox" class="ability-type" value="Control" /> Control</label>
            <label><input type="checkbox" class="ability-type" value="Utility" /> Utility</label>
            <label><input type="checkbox" class="ability-type" value="Reality-Bending" /> Reality-Bending</label>
          </fieldset>

          <fieldset class="checkbox-group">
            <legend>Desired Outcome / Shape</legend>
            <label><input type="checkbox" class="ability-outcome" value="Barrier / Shield" /> Barrier / Shield</label>
            <label><input type="checkbox" class="ability-outcome" value="Restrain / Bind" /> Restrain / Bind</label>
            <label><input type="checkbox" class="ability-outcome" value="Area Denial / Zone" /> Area Denial / Zone</label>
            <label><input type="checkbox" class="ability-outcome" value="Morphing / Weapon Form" /> Morphing / Weapon Form</label>
            <label><input type="checkbox" class="ability-outcome" value="Overcharge / Self-Buff" /> Overcharge / Self-Buff</label>
            <label><input type="checkbox" class="ability-outcome" value="High Damage / Burst" /> High Damage / Burst</label>
            <label><input type="checkbox" class="ability-outcome" value="Battlefield Control" /> Battlefield Control</label>
            <label><input type="checkbox" class="ability-outcome" value="Signature Finisher" /> Signature Finisher</label>
          </fieldset>

          <label>
            Outcome / Effect Notes
            <textarea id="ability-outcome-notes" rows="2" placeholder="Describe what you want the move to look like in the scene and the exact outcome."></textarea>
          </label>

          <label>
            Mechanical Effect
            <textarea id="ability-mechanical" rows="3" placeholder="What happens on hit / failed save, conditions, battlefield changes, etc."></textarea>
          </label>

          <label>
            Combo / Interaction Notes
            <textarea id="ability-combo" rows="2" placeholder="How this interacts with Homies, Domains, or other abilities."></textarea>
          </label>

          <div class="button-row">
            <button id="btn-ability-manual" class="btn-secondary" type="button">Create Ability Manually</button>
            <button id="btn-ability-ai" class="btn-primary" type="button">Generate via AI</button>
          </div>
        </div>

        <div class="subpanel">
          <h3>Ability List</h3>
          <p class="subpanel-help">
            Browse all abilities – manual and AI-generated. Use the copy button on each card to paste into your character sheet.
          </p>

          <label>
            Filter Abilities
            <input id="ability-filter" type="text" placeholder="Search abilities..." />
          </label>

          <div id="ability-list" class="card-list slim-scroll">
            <!-- populated by JS -->
          </div>
        </div>
      </div>
    </section>

    <!-- Panel 4 – DOMAINS & LAIR ACTIONS -->
    <section class="panel" id="panel-domains">
      <h2 class="panel-title">Panel 4 – Domains &amp; Territories</h2>
      <div class="panel-body two-column">
        <div class="subpanel">
          <h3>Create a Domain</h3>
          <p class="subpanel-help">
            Build Big Mom–style territories. Invest SPU, set a passive Fear DC, and bind Territory Homies to shape the land.
          </p>

          <label>
            Domain Name
            <input id="domain-name" type="text" placeholder="Wano" />
          </label>

          <div class="three-column">
            <label>
              Domain Tier (1–10)
              <input id="domain-tier" type="number" min="1" max="10" value="5" />
            </label>
            <label>
              SPU Invested into Domain
              <input id="domain-spu" type="number" min="0" step="50" value="0" />
            </label>
            <label>
              Passive Fear DC (entering enemies)
              <input id="domain-dc" type="number" min="0" value="15" />
            </label>
          </div>

          <label>
            Territory Size / Range
            <input id="domain-range" type="text" placeholder="100 miles" />
          </label>

          <label>
            Environmental Personality
            <textarea id="domain-personality" rows="2" placeholder="Heavily wooded land covered in living trees and foliage. The land consumes, confuses, and traps intruders."></textarea>
          </label>

          <label>
            Domain Notes
            <textarea id="domain-notes" rows="2" placeholder="Anything special about this domain, politics, factions, etc."></textarea>
          </label>

          <label>
            Assign Territory Homies
            <select id="domain-homies" multiple size="5">
              <!-- options via JS -->
            </select>
            <span class="field-help">Hold Ctrl/Cmd to select multiple Territory Homies.</span>
          </label>

          <div class="button-row">
            <button id="btn-create-domain" class="btn-primary" type="button">Create Domain</button>
          </div>
        </div>

        <div class="subpanel">
          <h3>Domains Overview &amp; Lair Actions</h3>
          <p class="subpanel-help">
            Manage your Domains, see their fear pressure, control radius, and which Homies guard them.
            Generate or reroll lair actions as separate cards.
          </p>

          <label>
            Filter Domains
            <input id="domain-filter" type="text" placeholder="Search domains..." />
          </label>

          <div id="domain-list" class="card-list slim-scroll">
            <!-- populated by JS -->
          </div>
        </div>
      </div>
    </section>

    <!-- Panel 5 – USE MODE DASHBOARD -->
    <section class="panel" id="panel-dashboard">
      <h2 class="panel-title">Panel 5 – Soul Party Dashboard (Playable View)</h2>
      <p class="panel-intro">
        Snapshot of your Homies, Domains, and key abilities. Use the dropdown cards during play to quickly see stats and attacks.
      </p>

      <div class="panel-body single-column">
        <div class="subpanel">
          <h3>Homies</h3>
          <div id="dashboard-homies" class="accordion-list">
            <!-- populated by JS -->
          </div>
        </div>

        <div class="subpanel">
          <h3>Domains &amp; Lair Actions</h3>
          <div id="dashboard-domains" class="accordion-list">
            <!-- populated by JS -->
          </div>
        </div>
      </div>
    </section>
  </main>

  <script src="script.js"></script>
</body>
</html>
